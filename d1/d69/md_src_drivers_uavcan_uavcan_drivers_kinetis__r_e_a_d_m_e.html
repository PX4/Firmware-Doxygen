<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PX4 Firmware: libuavcan_kinetis</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PX4 Firmware
   </div>
   <div id="projectbrief">PX4 Autopilot Software http://px4.io</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d1/d69/md_src_drivers_uavcan_uavcan_drivers_kinetis__r_e_a_d_m_e.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">libuavcan_kinetis </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Libuavcan platform driver for Kinetis FlexCAN</p>
<p>The Directory contains the Kinetis FlexCAN platform driver for Libuavcan on NuttX.</p>
<p>Configuation is set by the NuttX board.h for the following:</p>
<table class="doxtable">
<tr>
<th>Driver </th><th>board.h  </th></tr>
<tr>
<td>OSCERCLK </td><td>BOARD_EXTAL_FREQ </td></tr>
<tr>
<td>busclck </td><td>BOARD_BUS_FREQ </td></tr>
</table>
<p>and the following commandline defines:</p>
<table class="doxtable">
<tr>
<th>Setting </th><th>Description  </th></tr>
<tr>
<td>UAVCAN_KINETIS_NUM_IFACES </td><td>- {1..2} Sets the number of CAN interfaces the SW will support </td></tr>
<tr>
<td>UAVCAN_KINETIS_TIMER_NUMBER </td><td>- {0..3} Sets the Periodic Interrupt Timer (PITn) channel </td></tr>
</table>
<p>Things that could be improved:</p><ol type="1">
<li>Build time command line configuartion of Mailbox/FIFO and filters</li>
<li>Build time command line configuartion clock source<ul>
<li>Curently the driver use <code>const uavcan::uint8_t CLOCKSEL = 0;</code> To Select OSCERCLK</li>
</ul>
</li>
<li>Dynamic filter disable. There are no filter enable bits on the FlexCAN, just the number of Filters can be set. But this changes the memory map. So the configuration show below has been chosen.</li>
</ol>
<div class="fragment"><div class="line">/* Layout of Fifo, filters and Message buffers  */</div><div class="line"></div><div class="line">enum { FiFo = 0 };</div><div class="line">/* 0                       */</div><div class="line">/* 1                       */</div><div class="line">/* 2                       */</div><div class="line">/* 3         Fifo          */</div><div class="line">/* 4                       */</div><div class="line">/* 5                       */</div><div class="line">enum { FirstFilter = 6 };</div><div class="line">/* 6                       */</div><div class="line">/* 7                       */</div><div class="line">/* 8         Filters       */</div><div class="line">/* 9                       */</div><div class="line">enum { NumHWFilters = 16 };</div><div class="line">enum { NumMBinFiFoAndFilters = 10 };</div><div class="line">/* 10                      */</div><div class="line">/* 11                      */</div><div class="line">/* 12                      */</div><div class="line">/* 13 Tx Message Buffers   */</div><div class="line">/* 14                      */</div><div class="line">/* 15                      */</div><div class="line">/*-- ----------------------*/</div></div><!-- fragment --><p>A dedicated example application may be added later here. For now, please consider the following open source projects as a reference:</p>
<ul>
<li><a href="https://github.com/PX4/sapog">https://github.com/PX4/sapog</a></li>
<li><a href="https://github.com/Zubax/zubax_gnss">https://github.com/Zubax/zubax_gnss</a></li>
<li><a href="https://github.com/PX4/Firmware">https://github.com/PX4/Firmware</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
